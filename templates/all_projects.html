{% block content %}
{% include "header.html" %}

<!-- Page Header-->
<header class="masthead low_contrast py-5"
        style="background-image: url('{{ url_for('static', filename='assets/image/background_images/show_project_bg.png') }}')"
>
  <div class="container px-3 col-lg col-sm">
    <div class="container px-3">
      <div class="row align-items-center mt-5 mb-0">
        <div class="col-3">
          <div class="w-100 p-3">
            <img class="img-fluid rounded-circle"
                 src="{{ url_for('static', filename='assets/image/John pp pic.jpeg') }}"
                 alt="Profile picture"
            >
          </div>
        </div>
        <div class="col-9 col-lg-9 col-sm-9">
          <div class="p-1 w-100">
            <div class="site-heading text-center">
              <h1>Python Solutions</h1>
              <span class="subheading text-light">A showcase of real-world problems solved using Python.</span>
              {% with messages = get_flashed_messages() %}
                {% if messages %}
                  <ul class="flashes">
                    {% for message in messages %}
                      <li>{{ message }}</li>
                    {% endfor %}
                  </ul>
                {% endif %}
              {% endwith %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>


<!-- Main Content-->
<div class="container py-5 px-4 px-lg-5">
  <div class="row gx-4 gx-lg-5 justify-content-center">
    <div class="col-md-10 col-lg-8 col-xl-7 py-3">
      <!-- Post preview-->
      {% for project in all_projects %}
      <div class="post-preview post-header mb-5">
        <div class="post-image">
          <img src="{{ project.img_url }}" alt="Post image">
        </div>

        <div class="post-text">
          <a href="{{ url_for('show_project', project_id=project.id) }}">
            <h3 class="post-title">{{ project.title }}</h3>
            <h4 class="post-subtitle">{{ project.subtitle }}</h4>
        </a>
        </div>
        <!-- Delete a project -->
        {% if logged_in and current_user.id == 1 %}
        <div class="post-meta">
          <!-- <a class="btn btn-dark float-start" href="{{ url_for('edit_project', project_id=project.id) }}">Edit</a> -->
          <!-- <a class="btn btn-dark float-end" href="{{ url_for('delete', project_id=project.id) }}">❌</a> -->

          <!-- Creating a pop-up to confirm delete for security purpose -->
          <form method="POST"
                action="{{ url_for('delete', project_id=project.id) }}"
                onsubmit="return confirm('Are you sure you want to delete this project? This cannot be undone.')"
                class="d-inline">
            <button type="submit" class="btn btn-light float-end">❌</button>
          </form>
        </div>

        <!-- Divider-->
        <hr class="my-5" />
        {% else %}
        <hr class="my-3" />
        {% endif %}
      </div>
      {% endfor %}

      <!-- New Project -->
      {% if logged_in and current_user.id == 1 %}
      <div class="d-flex justify-content-end mt-5 mb-4">
      <!-- Adding new projects -->
        <a
          class="btn btn-secondary float-right"
          href="{{ url_for('create_project') }}"
        >
          Create New Project
        </a>
      </div>
      {% endif %}

      <!-- Pager-->
      <div class="d-flex justify-content-between mt-5 mb-4">
        {% if pagination.has_prev %}
          <a class="btn btn-secondary text-titlecase"
             href="{{ url_for('projects', page=pagination.prev_num) }}"
          >
            Newer Projects
          </a>
        {% endif %}

        {% if pagination.has_next %}
          <a class="btn btn-secondary text-titlecase"
             href="{{ url_for('projects', page=pagination.next_num) }}"
          >
            Older Projects →
          </a>
        {% endif %}
      </div>
        <!-- Show page count -->
        <div>
          <p class="d-flex justify-content-end text-muted small">
            Page {{ pagination.page }} of {{ pagination.pages }}
          </p>
        </div>


      </div>
  </div>
</div>

{% include "footer.html" %}
{% endblock %}